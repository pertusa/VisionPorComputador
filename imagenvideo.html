
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="intro.html">
      
      
        <link rel="next" href="transformaciones.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>T2- Imagen digital y vídeo - Visión por Computador</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="Teal" data-md-color-accent="Teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tema-2-imagen-digital-y-video" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="." title="Visión por Computador" class="md-header__button md-logo" aria-label="Visión por Computador" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Visión por Computador
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              T2- Imagen digital y vídeo
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Visión por Computador" class="md-nav__button md-logo" aria-label="Visión por Computador" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Visión por Computador
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="install.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instalación de OpenCV
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="intro.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    T1- Introducción
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    T2- Imagen digital y vídeo
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="imagenvideo.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    T2- Imagen digital y vídeo
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cambios-de-resolucion-espacial-y-radiometrica" class="md-nav__link">
    <span class="md-ellipsis">
      Cambios de resolución espacial y radiométrica
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#brillocontraste" class="md-nav__link">
    <span class="md-ellipsis">
      Brillo/contraste
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Brillo/contraste">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#histogramas" class="md-nav__link">
    <span class="md-ellipsis">
      Histogramas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Histogramas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio_1" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conversion-de-espacios-de-color" class="md-nav__link">
    <span class="md-ellipsis">
      Conversión de espacios de color
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conversión de espacios de color">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio_2" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudocolor" class="md-nav__link">
    <span class="md-ellipsis">
      Pseudocolor
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="transformaciones.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    T3- Transformaciones
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="deteccion.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    T4- Detección
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cambios-de-resolucion-espacial-y-radiometrica" class="md-nav__link">
    <span class="md-ellipsis">
      Cambios de resolución espacial y radiométrica
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#brillocontraste" class="md-nav__link">
    <span class="md-ellipsis">
      Brillo/contraste
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Brillo/contraste">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#histogramas" class="md-nav__link">
    <span class="md-ellipsis">
      Histogramas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Histogramas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio_1" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conversion-de-espacios-de-color" class="md-nav__link">
    <span class="md-ellipsis">
      Conversión de espacios de color
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conversión de espacios de color">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio_2" class="md-nav__link">
    <span class="md-ellipsis">
      Ejercicio
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudocolor" class="md-nav__link">
    <span class="md-ellipsis">
      Pseudocolor
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="tema-2-imagen-digital-y-video">Tema 2- Imagen digital y vídeo<a class="headerlink" href="#tema-2-imagen-digital-y-video" title="Permanent link">&para;</a></h1>
<p>En este tema trabajaremos con cambios de resolución de imágenes, histogramas, brillo/contraste y conversión entre espacios de color.</p>
<h2 id="cambios-de-resolucion-espacial-y-radiometrica">Cambios de resolución espacial y radiométrica<a class="headerlink" href="#cambios-de-resolucion-espacial-y-radiometrica" title="Permanent link">&para;</a></h2>
<p>En OpenCV podemos cambiar la resolución espacial (es decir, el tamaño de la imagen) con la función <code>resize</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Guardamos la imagen img en dst con el 75% de su tamaño original</span>
<span class="n">dst</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">fx</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">fy</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>

<span class="c1"># Guardamos la imagen en destino con un tamaño de 640 x 480 (ancho x alto)</span>
<span class="n">dst</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">640</span><span class="p">,</span><span class="mi">480</span><span class="p">))</span>
</code></pre></div>
<p>Para cambiar sólo el tipo de dato de la imagen, que está relacionado con la resolución radiométrica o <em>depth</em> (el número de bits usados para representar el valor de un píxel), podemos realizar una conversión con <code>numpy</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">converted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="c1"># Convertir a float y guardar en dst</span>
</code></pre></div>
<h2 id="brillocontraste">Brillo/contraste<a class="headerlink" href="#brillocontraste" title="Permanent link">&para;</a></h2>
<p>Tal como puedes ver en las transparencias de teoría, el brillo y contraste de una imagen se definen con las siguientes ecuaciones:</p>
<p><img alt="Brightness" src="images/imagenvideo/brightness.png" /></p>
<p><img alt="Contrast" src="images/imagenvideo/contrast.png" /></p>
<hr />
<h3 id="ejercicio">Ejercicio<a class="headerlink" href="#ejercicio" title="Permanent link">&para;</a></h3>
<p>Implementa un programa en OpenCV llamado <code>bc.py</code> que reciba por parámetro el nombre de una imagen (que debemos cargar en escala de grises) y muestre por el terminal su brillo y contraste. Los parámetros de entrada deben indicarse de la siguiente forma:</p>
<!--
WM: imagen dada. (palabra "dada") ### 2023-24
WM: para obtener. (palabra "obtener"; antes era "calcular") ### 2024-25
WM: tanto el brillo como el contrates. (antes era "el brillo y el contraste") ### 2024-25

# 25/26
WM: Eliminado "dada." al final de description
-->

<div class="highlight"><pre><span></span><code><span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Programa para obtener tanto el brillo como el contraste de una imagen.&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--imagen&#39;</span><span class="p">,</span> <span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;lena.jpg&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Ejemplo de ejecución:</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>bc.py
<span class="nv">b</span><span class="o">=</span><span class="w"> </span><span class="m">120</span>.444
<span class="nv">c</span><span class="o">=</span><span class="w"> </span><span class="m">48</span>.221
</code></pre></div>
<blockquote>
<p>Importante: Como la corrección de prácticas es automática, la salida del programa debe tener exactamente el formato que se indica, por lo que la última línea del código debería ser como la siguiente:</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;b= </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">brillo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;c= </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">contraste</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Las variables <em>brillo</em> y <em>contraste</em> son los valores que debes calcular usando las ecuaciones anteriores.</p>
</blockquote>
<!---
_Pista_: Para implementar el brillo se puede usar la función `mean` de OpenCV, que devuelve la media de los valores de una matriz:

<div class="highlight"><pre><span></span><code><span class="n">Scalar</span><span class="w"> </span><span class="n">meanI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">image</span><span class="p">);</span>
<span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;b= &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">meanI</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
</code></pre></div>

Sin embargo esto no serviría para el contraste por lo que en este ejercicio hay que implementar el bucle a mano.
--->

<hr />
<!--
Mat dx,dy;
Sobel(img,dx,1,0,3,CV_32F);
Sobel(img,dy,0,1,3,CV_32F);
G= sqrt(G2^2+G2^2)
-->

<h2 id="histogramas">Histogramas<a class="headerlink" href="#histogramas" title="Permanent link">&para;</a></h2>
<p>Podemos calcular el histograma de una imagen con la función <code>calcHist</code>. Esta función recibe muchos parámetros porque está pensada para calcular de una pasada todos los histogramas de un array de imágenes.</p>
<p>Parámetros de <code>calcHist</code>:</p>
<ul>
<li><code>images</code>: Array de imágenes, deben tener la misma resolución, tipo y el mismo tamaño, aunque pueden tener un número distinto de canales. Tiene que indicarse entre corchetes, por ejemplo <code>[img]</code>.</li>
<li><code>channels</code>: También se da entre corchetes. Es la lista de los canales usados para calcular el histograma, comenzando por el número de canal 0. Si es escala de grises se puede indicar <code>[0]</code>, y en color <code>[0]</code>, <code>[1]</code> o <code>[2]</code> para calcular los histogramas de azul, verde y rojo respectivamente.</li>
<li><code>mask</code>: Matriz opcional para usar una máscara binaria. Para obtener el histograma de la imagen completa se pone <code>None</code>.</li>
<li><code>histSize</code>: Representa cuántos elementos tenemos en el vector del histograma y se pone entre corchetes, normalmente serán <code>[256]</code>. </li>
<li><code>ranges</code>: Rango de los valores mínimos y máximos para cada imagen, normalmente es <code>[0,256]</code>.</li>
</ul>
<p>Veamos un ejemplo de código que calcula el histograma de una imagen en escala de  grises, lo muestra por el terminal y crea una gráfica en una ventana:</p>
<!----
https://docs.opencv.org/master/d1/db7/tutorial_py_histogram_begins.html
---->

<!--
# 2023/24 # 
WM: imagen dada. (añadido "dada")
args.imagen,cv.IMREAD_GRAYSCALE (quitar espacio entre argumentos)
leer la imagen~" (cambiar "cargar" por "leer")
entre 0 y 255 -> en el rango [0,255].
Guardamos el resultado en un archivo -> Guardadmos el resultado
Mostramos el histograma en pantalla -> Mostramos el resultado por pantalla

# 2024/25 # 
WM: para obtener (antes, "para calcular")
WM: Leemos la imagen (antes, "Cargamos la imagen")
WM: Comprobamos la carga de la imagen (antes, "Comprobamos que la imagen se ha podido leer")
WM: Obtenemos el histograma (antes, "Calculamos el histograma")
WM: Lo mostramos usando la librería matplotlib (antes, "Lo mostramos, para esto usamos la librería matplotlib")
WM: Volcamos el resultado (antes, "Guardamos el resultado")

# 2025/26
WM: Eliminado "dada." al final de parser.
WM: "Comprobamos la carga de la imagen" -> "Comprobamos la lectura de la imagen"
-->

<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cv</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Programa para obtener el histograma de una imagen.&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--imagen&#39;</span><span class="p">,</span> <span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;lena.jpg&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--histograma&#39;</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;histograma.png&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

<span class="c1"># Leemos la imagen indicada por el usuario</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">imagen</span><span class="p">,</span><span class="n">cv</span><span class="o">.</span><span class="n">IMREAD_GRAYSCALE</span><span class="p">)</span> 

<span class="c1"># Comprobamos la lectura de la imagen</span>
<span class="k">if</span> <span class="n">img</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error al leer la imagen &quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">imagen</span><span class="p">)</span>
    <span class="n">quit</span><span class="p">()</span>

<span class="c1"># Obtenemos el histograma</span>
<span class="n">hist</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">calcHist</span><span class="p">([</span><span class="n">img</span><span class="p">],[</span><span class="mi">0</span><span class="p">],</span><span class="kc">None</span><span class="p">,[</span><span class="mi">256</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">256</span><span class="p">])</span>

<span class="c1"># Lo mostramos usando la librería matplotlib</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span> <span class="c1"># El segundo parámetro es el color de la línea (&#39;b&#39;, &#39;g&#39;, o &#39;r&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">256</span><span class="p">])</span> <span class="c1"># Para ajustar mejor el eje x y que sólo se vean los valores en el rango [0,255].</span>

<span class="c1"># Volcamos el resultado en un archivo</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">histograma</span><span class="p">)</span>

 <span class="c1"># Mostramos el resultado por pantalla</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<hr />
<h3 id="ejercicio_1">Ejercicio<a class="headerlink" href="#ejercicio_1" title="Permanent link">&para;</a></h3>
<p>Cuando la imagen es de tres canales, lo más normal es mostrar un histograma para cada uno de ellos. Haz una copia del programa anterior y llámalo <code>histogramaColor.py</code>. Modifícalo para que en este caso el programa muestre en una ventana (y guarde en una imagen) el histograma de sus tres colores básicos, en lugar de hacerlo en escala de grises. </p>
<p>Ejemplo de salida con <code>lena.jpg</code>:</p>
<p><img alt="Histograma color" src="images/imagenvideo/histograma.png" /></p>
<h2 id="conversion-de-espacios-de-color">Conversión de espacios de color<a class="headerlink" href="#conversion-de-espacios-de-color" title="Permanent link">&para;</a></h2>
<p>OpenCV soporta más de 150 espacios de color. La función que realiza las conversiones entre ellos es <code>cvtColor</code>, y admite hasta 4 parámetros:</p>
<ul>
<li><code>src</code>: Imagen de entrada</li>
<li><code>code</code>: Código de conversión del espacio de color. Su estructura es <code>COLOR_SPACEsrc2SPACEdst</code>. Ejemplos: <code>COLOR_BGR2GRAY</code>, <code>COLOR_YCrCb2BGR</code>.</li>
<li><code>dst</code> (opcional): Imagen de salida con el mismo tamaño y resolución (<code>depth</code>) que la imagen de entrada.</li>
<li><code>dstCn</code> (opcional): El número de canales en la imagen destino. Si se omite el parámetro, se infiere del número de canales de la imagen <code>src</code> y de <code>code</code>.</li>
</ul>
<p>Ejemplo de uso:</p>
<div class="highlight"><pre><span></span><code><span class="n">grayImg</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Importante: La función <code>cvtColor</code> sólo convierte de BGR a otro espacio de color o viceversa, por lo que si queremos convertir una imagen entre dos espacios distintos de BGR, primero tenemos que pasarla a BGR y después al espacio destino.</p>
</blockquote>
<p>Ejemplos de conversión:</p>
<div class="highlight"><pre><span></span><code><span class="n">converted</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span> <span class="c1"># Convertir a escala de grises</span>
<span class="n">converted</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv</span><span class="o">.</span><span class="n">COLOR_BGR2Luv</span><span class="p">)</span> <span class="c1"># Convertir a LUV</span>
<span class="n">converted</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv</span><span class="o">.</span><span class="n">COLOR_BGR2XYZ</span><span class="p">)</span> <span class="c1"># Convertir a CIEXYZ</span>
</code></pre></div>
<p>Puedes consultar <a href="http://docs.opencv.org/2.4/modules/imgproc/doc/miscellaneous_transformations.html">en este enlace</a> todas las ecuaciones que usa OpenCV para conversión entre espacios. Por ejemplo, para convertir un valor RGB en escala de grises se usa la siguiente fórmula: 0.299*R + 0.587*G+ 0.114*B.</p>
<p>Ten en cuenta que OpenCV a veces no usa el mismo orden de canales que el estándar del espacio de color. Por ejemplo, RGB se codifica en OpenCV como BGR, y HSL se codifica como HLS, por lo que el último canal que almacena en este caso es S en lugar de L.</p>
<hr />
<h3 id="ejercicio_2">Ejercicio<a class="headerlink" href="#ejercicio_2" title="Permanent link">&para;</a></h3>
<p>Haz un programa llamado <code>colorLight.py</code> que reciba por parámetro el nombre de una imagen y extraiga los canales que se muestran a continuación, guardándolos <strong>exactamente</strong> con el siguiente nombre de fichero:</p>
<ul>
<li>El canal <strong>L</strong> de CIELab, fichero <code>cielab_l.jpg</code>.</li>
<li>El canal <strong>V</strong> de HSV, fichero  <code>hsv_v.jpg</code>.</li>
<li>El canal <strong>L</strong> de HSL, fichero  <code>hsl_l.jpg</code>.</li>
<li>El canal <strong>Y</strong> de YCrCb, fichero  <code>ycrcb_y.jpg</code>.</li>
</ul>
<p>Argumentos de entrada:</p>
<!--
# 2023/24
WM: entre espacios de color. (añadido "entre")
Espacio al final de la línea

# 2024/25
WM: de una imagen dada. (antes no estaba esta cadena de texto)
WM: description='Programa (antes, "description = 'Programa")
WM: default = 'Fire (antes, "default='Fire")

# 25/26
WM: eliminado "dada."
-->

<div class="highlight"><pre><span></span><code><span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Programa para cambiar entre espacios de color de una imagen.&#39;</span><span class="p">)</span> 
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--imagen&#39;</span><span class="p">,</span> <span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span> <span class="o">=</span> <span class="s1">&#39;Fire_breathing_2_Luc_Viatour.jpg&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Para hacer pruebas puedes usar la siguiente imagen:</p>
<!---
![Fire breathing](https://commons.wikimedia.org/wiki/File:Fire_breathing_2_Luc_Viatour.jpg#/media/File:Fire_breathing_2_Luc_Viatour.jpg")
--->

<p><a href="https://commons.wikimedia.org/wiki/File:Fire_breathing_2_Luc_Viatour.jpg#/media/File:Fire_breathing_2_Luc_Viatour.jpg"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/02/Fire_breathing_2_Luc_Viatour.jpg/1200px-Fire_breathing_2_Luc_Viatour.jpg" alt="A full-color image shows a high-contrast and quite dramatic scene of a fire breather with a large orange-yellow flame extending from his lips. He wears dark but colorful orange-red clothing."></a><br>Imagen de <a href="//commons.wikimedia.org/wiki/User:Lviatour" title="User:Lviatour">Luc Viatour</a>, <a href="http://creativecommons.org/licenses/by-sa/3.0/" title="Creative Commons Attribution-Share Alike 3.0">CC BY-SA 3.0</a>, <a href="https://commons.wikimedia.org/w/index.php?curid=4632541">Wikimedia</a>.</p>
<blockquote>
<p>Pista: Se puede usar el método <code>split</code> para separar los canales de una imagen. Ejemplo: 
<div class="highlight"><pre><span></span><code><span class="n">b</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</code></pre></div>
Alternativamente, también se puede usar <code>numpy</code> para obtener el canal que nos interese:
<div class="highlight"><pre><span></span><code><span class="n">b</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Canal azul</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Canal verde</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Canal rojo</span>
</code></pre></div></p>
</blockquote>
<hr />
<h2 id="pseudocolor">Pseudocolor<a class="headerlink" href="#pseudocolor" title="Permanent link">&para;</a></h2>
<p>Mediante la función <code>applyColorMap</code> también podemos pseudocolorear imágenes en escala de grises usando los <a href="https://docs.opencv.org/4.12.0/d3/d50/group__imgproc__colormap.html">mapas de color predefinidos</a> en OpenCV. Por ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="n">img</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;pluto.jpg&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">.</span><span class="n">IMREAD_GRAYSCALE</span><span class="p">)</span>
<span class="n">imgray</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">applyColorMap</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv</span><span class="o">.</span><span class="n">COLORMAP_JET</span><span class="p">)</span>
</code></pre></div>
<p>Escribe un programa completo (no hay que entregarlo) que contenga este código de ejemplo para visualizar el resultado de pseudocolorear la siguiente imagen de Plutón obtenida por la sonda <em>New Horizons</em>:</p>
<p><img alt="Pluto" src="images/imagenvideo/pluto.jpg" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["content.code.copy"], "search": "assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>